<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>CLAUDE.md • surveydown</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" sizes="any" href="favicon.ico"><link rel="manifest" href="site.webmanifest"><script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="CLAUDE.md"><meta property="og:image" content="https://pkg.surveydown.org/reference/figures/logo.png"><meta property="og:image:alt" content="Logo for the surveydown package"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">surveydown</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.13.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="external-link nav-link" href="https://www.surveydown.org/">Documentation</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/surveydown-dev/surveydown/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>CLAUDE.md</h1>
      <small class="dont-index">Source: <a href="https://github.com/surveydown-dev/surveydown/blob/main/CLAUDE.md" class="external-link"><code>CLAUDE.md</code></a></small>
    </div>

<div id="claudemd" class="section level1">

<p>This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.</p>
<div class="section level2">
<h2 id="project-overview">Project Overview<a class="anchor" aria-label="anchor" href="#project-overview"></a></h2>
<p><strong>surveydown</strong> is an R package that creates markdown-based programmable surveys using Quarto, Shiny, and PostgreSQL. It enables researchers to define surveys in plain text (survey.qmd) and deploy them as interactive Shiny applications with data stored in PostgreSQL databases.</p>
</div>
<div class="section level2">
<h2 id="core-architecture">Core Architecture<a class="anchor" aria-label="anchor" href="#core-architecture"></a></h2>
<p>The package follows a dual-file survey structure: - <code>survey.qmd</code>: Quarto document containing survey content (pages, questions, etc.) - <code>app.R</code>: Shiny application with global settings, database configuration, and server logic</p>
<div class="section level3">
<h3 id="key-components">Key Components<a class="anchor" aria-label="anchor" href="#key-components"></a></h3>
<ul><li>
<strong>UI System</strong> (<code>R/ui.R</code>): <code><a href="reference/sd_ui.html">sd_ui()</a></code> creates the Shiny UI, reading theme and progress bar settings from survey.qmd YAML headers</li>
<li>
<strong>Server Logic</strong> (<code>R/server.R</code>): <code><a href="reference/sd_server.html">sd_server()</a></code> handles conditional display, progress tracking, page navigation, and database operations</li>
<li>
<strong>Configuration</strong> (<code>R/config.R</code>): <code>run_config()</code> parses survey.qmd files and extracts survey structure</li>
<li>
<strong>Database Interface</strong> (<code>R/db.R</code>): PostgreSQL integration with support for Supabase</li>
<li>
<strong>Utilities</strong> (<code>R/util.R</code>): Helper functions for survey processing and validation</li>
</ul></div>
<div class="section level3">
<h3 id="survey-flow">Survey Flow<a class="anchor" aria-label="anchor" href="#survey-flow"></a></h3>
<ol style="list-style-type: decimal"><li>Survey content is defined in a Quarto document (<code>survey.qmd</code>)</li>
<li>
<code>run_config()</code> parses the .qmd file and extracts pages/questions into <code>_survey/</code> folder</li>
<li>
<code><a href="reference/sd_ui.html">sd_ui()</a></code> creates the Shiny interface with theme and progress bar settings</li>
<li>
<code><a href="reference/sd_server.html">sd_server()</a></code> manages user interactions, conditional logic, and data storage</li>
</ol></div>
</div>
<div class="section level2">
<h2 id="development-commands">Development Commands<a class="anchor" aria-label="anchor" href="#development-commands"></a></h2>
<div class="section level3">
<h3 id="package-development">Package Development<a class="anchor" aria-label="anchor" href="#package-development"></a></h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load package for development</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">load_all</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate documentation</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">document</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install package locally</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span>force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run package checks</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">check</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build pkgdown documentation site</span></span>
<span><span class="fu">pkgdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">build_site</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a></h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run tests (currently minimal)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.surveydown.org">surveydown</a></span><span class="op">)</span></span>
<span><span class="co"># test_check("surveydown")  # Commented out in testthat.R</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-survey">Example Survey<a class="anchor" aria-label="anchor" href="#example-survey"></a></h3>
<p>Test the package using the example survey in <code>test_survey/app.R</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># From test_survey/ directory</span></span>
<span><span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html" class="external-link">runApp</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="database-integration">Database Integration<a class="anchor" aria-label="anchor" href="#database-integration"></a></h2>
<p>The package uses PostgreSQL databases with built-in Supabase support. Database connections are configured via: - <code><a href="reference/sd_db_config.html">sd_db_config()</a></code>: Store database credentials in .env file - <code><a href="reference/sd_db_connect.html">sd_db_connect()</a></code>: Establish database connection - Set <code>ignore = TRUE</code> for local testing without database storage</p>
</div>
<div class="section level2">
<h2 id="key-functions">Key Functions<a class="anchor" aria-label="anchor" href="#key-functions"></a></h2>
<ul><li>
<code><a href="reference/sd_ui.html">sd_ui()</a></code>: Generate survey UI from survey.qmd</li>
<li>
<code><a href="reference/sd_server.html">sd_server()</a></code>: Main server logic with conditional display, progress tracking</li>
<li>
<code><a href="reference/sd_skip_if.html">sd_skip_if()</a></code>: Define conditional skip logic</li>
<li>
<code><a href="reference/sd_database.html">sd_database()</a></code>: Database connection configuration</li>
<li>
<code>run_config()</code>: Parse and process survey content</li>
</ul></div>
<div class="section level2">
<h2 id="file-structure">File Structure<a class="anchor" aria-label="anchor" href="#file-structure"></a></h2>
<ul><li>
<code>R/</code>: Core package source code (ui.R, server.R, config.R, db.R, util.R, translation.R)</li>
<li>
<code>inst/</code>: Package resources and example files</li>
<li>
<code>man/</code>: Generated documentation</li>
<li>
<code>test_survey/</code>: Example survey application</li>
<li>
<code>tests/</code>: Test suite (currently minimal)</li>
<li>
<code>build.R</code>: Development build script</li>
</ul></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Paul Helveston, Pingfan Hu, Bogdan Bunea.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

