% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/util.R
\name{sd_use_db}
\alias{sd_use_db}
\title{Use Database Connection for Session}
\usage{
sd_use_db(db = NULL)
}
\arguments{
\item{db}{A database connection object, typically created with sd_db_connect().
If not provided (NULL), the function will automatically look for a variable
named 'db' in the calling environment. This should be a valid database pool
or connection that can be used for storing and retrieving survey data.}
}
\value{
Invisible NULL. The function is called for its side effect of making
the database connection available to the session.
}
\description{
This function makes a database connection available to the current Shiny session,
enabling functions like sd_sample() and sd_completion_code() to use database
persistence. This is a convenience function that replaces the manual assignment
of session$userData$db.
}
\details{
This function must be called within a Shiny server function as it requires
access to the current session object. It makes the database connection available
to other surveydown functions for data persistence.

Using this database connection enables:
\itemize{
\item Session-persistent sampling with sd_sample()
\item Session-persistent completion codes with sd_completion_code()
\item Consistent data storage across page refreshes
}

\strong{Important}: This function should be called early in your server function,
typically right after creating the database connection and before calling
any functions that require database persistence.
}
\examples{
if (interactive()) {
  # In a surveydown server function:
  server <- function(input, output, session) {
    # Create database connection
    db <- sd_db_connect()
    
    # Option 1: Explicitly pass the database connection
    sd_use_db(db)
    
    # Option 2: Let sd_use_db() automatically find the 'db' variable
    sd_use_db()  # Automatically uses the 'db' variable above
    
    # Now other functions can access the database
    completion_code <- sd_completion_code(10, id = "completion_code")
    sample_value <- sd_sample(c("A", "B", "C"), "sample_id")
  }
}

}
